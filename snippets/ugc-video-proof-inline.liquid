{% liquid
  assign has_content = false
  if video != blank or image != blank or link != blank or caption != blank
    assign has_content = true
  endif
%}

{% if has_content %}
  <article class="opc-ugc-card" aria-label="UGC proof item {{ index }}">
    <div class="opc-ugc-media">
      {% if video != blank %}
        {{
          video
          | video_tag:
            controls: false,
            autoplay: true,
            loop: true,
            muted: true,
            preload: 'auto',
            playsinline: true,
            image_size: '1200x'
        }}
      {% elsif image != blank %}
        {{
          image
          | image_url: width: 1200
          | image_tag:
            loading: 'lazy',
            widths: '320, 480, 720, 960, 1200',
            sizes: '(min-width: 990px) 25vw, 50vw',
            alt: caption | default: 'UGC proof image'
        }}
      {% else %}
        <div class="opc-media-placeholder">Add UGC video or image</div>
      {% endif %}
    </div>

    <div class="opc-ugc-content">
      {% if caption != blank %}
        <p class="opc-ugc-caption">{{ caption }}</p>
      {% endif %}

      {% if link != blank %}
        {% liquid
          assign ugc_link_label = 'View source'
          if link contains 'tiktok'
            assign ugc_link_label = 'View on TikTok'
          endif
        %}
        <a
          class="opc-ugc-link"
          href="{{ link }}"
          target="_blank"
          rel="nofollow noopener noreferrer"
          aria-label="Open source link for UGC item {{ index }}"
        >
          {% if link contains 'tiktok' %}
            <span class="opc-ugc-platform" aria-hidden="true">
              <svg viewBox="0 0 48 48" role="img" aria-hidden="true" focusable="false">
                <path d="M34.6 18.4c-2.6-1.5-4.3-4.3-4.6-7.4h-5.2v20.3c0 2.3-1.9 4.2-4.2 4.2s-4.2-1.9-4.2-4.2 1.9-4.2 4.2-4.2c.5 0 1 .1 1.5.3v-5.3c-.5-.1-1-.1-1.5-.1-5.2 0-9.3 4.2-9.3 9.3s4.2 9.3 9.3 9.3 9.3-4.2 9.3-9.3V22c1.7 1.2 3.8 1.9 6.1 1.9v-5.5c-1.1 0-2.1-.3-3.1-0.9z" />
              </svg>
            </span>
          {% endif %}
          <span>{{ ugc_link_label }}</span>
        </a>
      {% endif %}
    </div>
  </article>
{% endif %}

